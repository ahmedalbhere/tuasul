<!DOCTYPE html>
<html lang="ar" dir="rtl">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>ğŸ¤ Ù†Ø§Ø·Ù‚ â€“ Ø§Ø³ØªÙ…Ø§Ø¹ Ù…Ø³ØªÙ…Ø±</title>

<style>
*{margin:0;padding:0;box-sizing:border-box}

body{
    font-family:Arial, sans-serif;
    background:linear-gradient(135deg,#1a237e,#000);
    min-height:100vh;
    display:flex;
    align-items:center;
    justify-content:center;
    padding:15px;
}

.container{
    background:#fff;
    width:100%;
    max-width:900px;
    border-radius:20px;
    padding:20px;
    box-shadow:0 20px 40px rgba(0,0,0,.4);
}

h1{
    text-align:center;
    color:#1a237e;
    font-size:2.8em;
    margin-bottom:15px;
}

.text-screen{
    background:#fff;
    border:3px solid #1a237e;
    border-radius:15px;
    padding:20px;
    min-height:260px;
    font-size:2em;
    font-weight:bold;
    overflow-y:auto;
    animation:glow 2s infinite alternate;
}

@keyframes glow{
    from{box-shadow:inset 0 0 10px #1a237e}
    to{box-shadow:inset 0 0 20px gold}
}

.controls{
    margin-top:15px;
    display:flex;
    gap:10px;
    flex-wrap:wrap;
    justify-content:center;
}

button,select{
    font-size:1.4em;
    padding:10px 22px;
    border-radius:40px;
    border:none;
    cursor:pointer;
    font-weight:bold;
}

select{
    border:2px solid #1a237e;
}

.start{background:#4CAF50;color:#fff}
.stop{background:#f44336;color:#fff}
.copy{background:#2196F3;color:#fff}
.clear{background:#ff9800;color:#fff}

.status{
    margin-top:15px;
    background:#e3f2fd;
    padding:10px;
    border-radius:40px;
    display:flex;
    justify-content:center;
    align-items:center;
    gap:10px;
    font-size:1.3em;
}

.led{
    width:14px;
    height:14px;
    border-radius:50%;
    background:#f44336;
}

@media(max-width:600px){
    h1{font-size:2.2em}
    .text-screen{font-size:1.6em}
}
</style>
</head>

<body>
<div class="container">
    <h1>ğŸ¤ Ù†Ø§Ø·Ù‚</h1>

    <div class="text-screen" id="voiceText">
        ğŸ”Š ÙÙŠ Ø§Ù†ØªØ¸Ø§Ø± Ø§Ù„ØªØ´ØºÙŠÙ„...
    </div>

    <div class="controls">
        <select id="lang">
            <option value="ar-SA">ğŸ‡¸ğŸ‡¦ Ø¹Ø±Ø¨ÙŠ</option>
            <option value="en-US">ğŸ‡ºğŸ‡¸ English</option>
        </select>

        <button class="start" id="start">â–¶ ØªØ´ØºÙŠÙ„ Ø§Ù„Ù…ÙŠÙƒØ±ÙˆÙÙˆÙ†</button>
        <button class="stop" id="stop">â¹ Ø¥ÙŠÙ‚Ø§Ù</button>
        <button class="copy" id="copy">ğŸ“‹ Ù†Ø³Ø®</button>
        <button class="clear" id="clear">ğŸ§¹ Ù…Ø³Ø­</button>
    </div>

    <div class="status">
        <div class="led" id="led"></div>
        <span id="statusText">Ø§Ù„Ù…ÙŠÙƒØ±ÙˆÙÙˆÙ† Ù…ØªÙˆÙ‚Ù</span>
    </div>
</div>

<script>
const voiceText = document.getElementById("voiceText");
const lang = document.getElementById("lang");
const startBtn = document.getElementById("start");
const stopBtn = document.getElementById("stop");
const copyBtn = document.getElementById("copy");
const clearBtn = document.getElementById("clear");
const led = document.getElementById("led");
const statusText = document.getElementById("statusText");

let recognition;
let finalText = "";
let userStopped = false;

function createRecognition(){
    const SR = window.SpeechRecognition || window.webkitSpeechRecognition;
    if(!SR){
        alert("Ø§Ù„Ù…ØªØµÙØ­ Ù„Ø§ ÙŠØ¯Ø¹Ù… Ø§Ù„ØªØ¹Ø±Ù Ø¹Ù„Ù‰ Ø§Ù„ØµÙˆØª");
        return null;
    }

    const rec = new SR();
    rec.lang = lang.value;
    rec.continuous = true;
    rec.interimResults = true;

    rec.onstart = () => {
        led.style.background = "#4CAF50";
        statusText.textContent = "ğŸ¤ ÙŠØ³ØªÙ…Ø¹ Ø§Ù„Ø¢Ù†...";
    };

    rec.onresult = (e) => {
        let interim = "";
        for(let i = e.resultIndex; i < e.results.length; i++){
            const t = e.results[i][0].transcript;
            if(e.results[i].isFinal){
                finalText += t + " ";
            }else{
                interim += t;
            }
        }
        voiceText.textContent = finalText + interim;
    };

    rec.onerror = (e) => {
        console.log("Ø®Ø·Ø£:", e.error);
    };

    rec.onend = () => {
        if(!userStopped){
            setTimeout(() => {
                recognition = createRecognition();
                recognition && recognition.start();
            }, 400);
        }else{
            led.style.background = "#f44336";
            statusText.textContent = "Ø§Ù„Ù…ÙŠÙƒØ±ÙˆÙÙˆÙ† Ù…ØªÙˆÙ‚Ù";
        }
    };

    return rec;
}

startBtn.onclick = () => {
    userStopped = false;
    finalText = "";
    voiceText.textContent = "ğŸ”Š Ø£Ø³ØªÙ…Ø¹...";
    recognition = createRecognition();
    recognition && recognition.start();
};

stopBtn.onclick = () => {
    userStopped = true;
    recognition && recognition.stop();
};

lang.onchange = () => {
    if(recognition){
        userStopped = true;
        recognition.stop();
        setTimeout(() => {
            userStopped = false;
            recognition = createRecognition();
            recognition && recognition.start();
        }, 500);
    }
};

copyBtn.onclick = () => {
    navigator.clipboard.writeText(voiceText.textContent);
};

clearBtn.onclick = () => {
    finalText = "";
    voiceText.textContent = "ğŸ§¹ ØªÙ… Ø§Ù„Ù…Ø³Ø­";
};
</script>
</body>
</html>
